\usepackage{url}
\usepackage{scrhack}
\usepackage[babel,german=quotes]{csquotes}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{hyperref}
\usepackage[nameinlink]{cleveref}
\usepackage[utf8]{luainputenc}
\usepackage[T1]{fontenc}
\usepackage{gentium}
\RequirePackage{ccicons}
\pagenumbering{roman}

\usepackage{float}
\let\origfigure=\figure
\let\endorigfigure=\endfigure
\renewenvironment{figure}[1][]{%
  \origfigure[H]
}{%
  \endorigfigure
}

% Provide a new Listing reference target:
\crefname{Listing}{Listing}{Listings}

\usepackage{inconsolata}
\usepackage{color}
\usepackage{wasysym}
\usepackage{ifthen}
\usepackage[
  paper=a4paper,
  left=30mm,
  right=25mm,
  top=25mm,
  bottom=20mm,
  includefoot,
  foot=\baselineskip,
  bindingoffset=0mm
]{geometry}

\usepackage{setspace}
\onehalfspacing

\usepackage{amssymb}
\usepackage{pifont}
\newcommand{\cmark}{\textcolor{ForestGreen}{\ding{51}}}%
\newcommand{\xmark}{\textcolor{red}{\ding{55}}}%
\newcommand{\qmark}{\textcolor{BurntOrange}{\ding{46}}}%

\hypersetup{colorlinks,breaklinks,urlcolor=ThesisLinkColor,linkcolor=ThesisFontColor}

\definecolor{gray75}{gray}{0.25}
\newcommand{\hsp}{\hspace{5pt}}

\usepackage{calc}
\usepackage{etoolbox}

\appto\chapterheadstartvskip{%
  \vspace{-7em}
  \smash{\makebox[0pt]{%
	\textcolor{ThesisBarColor}{%
      \usesizeofkomafont{chapter}\rule[-2.5\ht\strutbox-\dp\strutbox]{2\paperwidth}{1.5\baselineskip}%
  }}}
  \smash{\makebox[0pt]{%
	\textcolor{ThesisLinkColor}{%
		\hspace*{9cm}\usesizeofkomafont{chapter}\rule[-2.18\ht\strutbox]{2\paperwidth}{0.04\baselineskip}%
  }}}
}

\renewcommand\chapterformat{%
  \makebox[0pt][r]{\textcolor{gray}{\Huge\textsc{\thechapter}}\ \ \textcolor{gray75}{\smash{\rule[-2\dp\strutbox]{1.5pt}{1.801\baselineskip}}}}%
  \enskip%
}

\addtokomafont{disposition}{\rmfamily}
\addtokomafont{chapter}{\bfseries\color{ThesisFontColor}}
\addtokomafont{section}{\color{ThesisFontColor}}
\addtokomafont{subsection}{\color{ThesisFontColor}}
\addtokomafont{subsubsection}{\color{ThesisFontColor}}

\renewcommand{\labelitemi}{\textcolor{ThesisFontColor}{$\blacktriangleright$}}
\usepackage[automark,autooneside=false,headsepline]{scrlayer-scrpage}
\newcommand{\fancyPagemark}{%
    % EasterEgg
    \ifthenelse{\value{page}=42}{%
        % Horizontal and vertical flip
        \reflectbox{\scalebox{1}[-1]{\pagemark}}
    }{%
        \ifthenelse{\value{page}=23}{%
            % Horizontal flip
            \reflectbox{\pagemark}
        }{%
            \pagemark
        }%
    }%
}%

\clearpairofpagestyles
\ohead{\small{\leftmark}}
\ihead{\small{\scshape{\rightmark}}}
\cfoot*{\fancyPagemark}
\setlength{\footskip}{25pt}
\date{\today}

%\RedeclareSectionCommand[
%  beforeskip=6em,
%  afterskip=2\baselineskip]{chapter}
\RedeclareSectionCommand[
  beforeskip=-.3\baselineskip,
  afterskip=.3\baselineskip]{section}
\RedeclareSectionCommand[
  beforeskip=-.2\baselineskip,
  afterskip=.2\baselineskip]{subsection}
\RedeclareSectionCommand[
  beforeskip=-.5\baselineskip,
  afterskip=.25\baselineskip]{subsubsection}
\RedeclareSectionCommand[
  beforeskip=.5\baselineskip,
  afterskip=-1em]{paragraph}
\RedeclareSectionCommand[
  beforeskip=-.5\baselineskip,
  afterskip=-1em]{subparagraph}
